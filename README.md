# Tore.Service.GlobalExceptionMiddleware

Language: C#. (.Net 5)

Nuget package: [Tore.Service.GlobalExceptionMiddleware](https://www.nuget.org/packages/Tore.Service.GlobalExceptionMiddleware/)

Dependancies: None.

## GlobaleExceptionMiddleWare :

A standard middleware for .Net web API intercepting unhandled exceptions raised during requests.


For using it, modifications must be done in startup.cs:
```C#
// Add this to your startup.cs usings.

using Tore.Service;

```

If developer exception page is not used, add at service configure method before any other app.Use... commands :

```C#
  public void Configure(IApplicationBuilder app, IWebHostEnvironment env) {
      
      // If an exception response builder method defined bind it:
      GlobalExceptionMiddleWare.exceptionResponseBuilder = aStaticMethodToBuildExceptionResponse;
      // Bind global exception middleware.
      app.UseMiddleware<GlobalExceptionMiddleware>();
      
      app.UseRouting();
 
      app.UseAuthorization();

      app.UseEndpoints(endpoints => {endpoints.MapControllers();});
  }
```

If developer exception page is needed during development : 

```C#

  public void Configure(IApplicationBuilder app, IWebHostEnvironment env) {
      // This part is traditionally generated by project builder.
      if(env.IsDevelopment()) { 
          app.UseDeveloperExceptionPage();
          app.UseSwagger();    // Maybe there is swagger too.
          app.UseSwaggerUI(c => c.SwaggerEndpoint("/swagger/v1/swagger.json", "NameOfTheProject v1"));
      
      } else {                        // We add the else block... 
          // Non development only...
          // If an exception response builder method defined, bind it :
          GlobalExceptionMiddleWare.exceptionResponseBuilder = aStaticMethodToBuildExceptionResponse;
          // Bind global exception middleware.  
          app.UseMiddleware<GlobalExceptionMiddleware>();
      }
      
      app.UseRouting();

      app.UseAuthorization();

      app.UseEndpoints(endpoints => { endpoints.MapControllers();});
}
                                        

```  

Note that this does not handle invalid routes. 
For that invalid routes must be rerouted to an endpoint,
If that endpoint raises exception, then GlobalExceptionMiddleware is activated.
